define(["require","exports","./pager-templates-constants"],function(e,t,a){"use strict";var i=function(){function e(e,t,a){this.noopLogger={debug:this.noop,error:this.noop,exception:this.noop,info:this.noop,log:this.noop,trace:this.noop,warn:this.noop},this.logger=a||this.noopLogger,this.logger.debug("constructor"),this.options=this.createOptions(e),this.currentPage=e.firstPage,this.updatePagerState(this.options),this.parentElement=t||document.body;var i=this.buildPager(this.options);this.parentElement.appendChild(i)}return e.prototype.pageTo=function(e){this.logger.debug("pageTo("+e+")"),e>0&&e<=this.totalNumberOfPages&&(this.displayPageInput=this.convertFromDecimal(e),this.currentPage=this.displayPageInput,this.updatePager())},e.prototype.updatePager=function(){this.updatePagerState(this.options);var e=this.buildPager(this.options),t=document.getElementById("pager-container-"+this.id);t?t.parentElement.replaceChild(e,t):this.parentElement.appendChild(e),this.parentElement.dispatchEvent(new CustomEvent("change",{detail:{id:this.id}}))},e.prototype.updateCurrentPage=function(){this.logger.debug("updateCurrentPage");var e=this.pageInputIsValid(),t=document.getElementById("page-input-"+this.id);e?(this.pageTo(this.convertToDecimal.call(this,this.displayPageInput)),t.classList.contains("invalid")&&t.classList.remove("invalid")):t.classList.contains("invalid")||t.classList.add("invalid")},e.prototype.pageInputIsValid=function(){this.logger.debug("pageInputIsValid");var e=this.convertToDecimal(this.displayPageInput);return!!e&&!isNaN(e)&&e>=1&&e<=this.totalNumberOfPages},Object.defineProperty(e.prototype,"displayPageInput",{get:function(){return parseInt(this.input.value,10)},set:function(e){this.input&&(this.input.value=e.toString())},enumerable:!0,configurable:!0}),e.prototype.createOptions=function(e){return this.logger.debug("createOptions"),e=e||{},e.firstPage=e.firstPage||1,e.convertFromDecimal=e.convertFromDecimal||this.convertFromDecimal.bind(this),e.convertToDecimal=e.convertToDecimal||this.convertToDecimal.bind(this),e.totalNumberOfRecords=e.totalNumberOfRecords||0,e.enableFirstLastPageArrows=e.enableFirstLastPageArrows||!1,e.enablePageArrows=e.enablePageArrows||!1,e.enablePageInput=e.enablePageInput||!1,e.maximumNumberOfExplicitPagesToDisplay=Math.max(e.maximumNumberOfExplicitPagesToDisplay||7,5),e.pageSize=e.pageSize||10,e.id=e.id||Math.floor(1e4*Math.random()).toString(),e},e.prototype.createTemplates=function(e){return this.logger.debug("createTemplates"),e=e||{},e.pageToBeginningHtml=e.pageToBeginningHtml||a.PagerTemplateConstants.DEFAULT_PAGE_TO_BEGINNING_HTML,e.pageRetreatHtml=e.pageRangeHtml||a.PagerTemplateConstants.DEFAULT_PAGE_RETREAT_HTML,e.pageToFirstHtml=e.pageToFirstHtml||a.PagerTemplateConstants.DEFAULT_PAGE_TO_FIRST_HTML,e.pageFillerBeforeHtml=e.pageFillerBeforeHtml||a.PagerTemplateConstants.DEFAULT_PAGE_FILLER_BEFORE_HTML,e.pageRangeHtml=e.pageRangeHtml||a.PagerTemplateConstants.DEFAULT_PAGE_RANGE_HTML,e.pageFillerAfterHtml=e.pageFillerAfterHtml||a.PagerTemplateConstants.DEFAULT_PAGE_FILLER_AFTER_HTML,e.pageToLastHtml=e.pageToLastHtml||a.PagerTemplateConstants.DEFAULT_PAGE_TO_LAST_HTML,e.pageAdvanceHtml=e.pageAdvanceHtml||a.PagerTemplateConstants.DEFAULT_PAGE_ADVANCE_HTML,e.pageToEndHtml=e.pageToEndHtml||a.PagerTemplateConstants.DEFAULT_PAGE_TO_END_HTML,e},e.prototype.convertFromDecimal=function(e){return this.logger.debug("convertFromDecimal("+e+")"),e},e.prototype.convertToDecimal=function(e){return this.logger.debug("convertToDecimal("+e+")"),parseInt(e,10)},e.prototype.noop=function(){},e.prototype.updatePagerState=function(e){this.logger.debug("updatePagerState"),this.totalNumberOfPages=e.pageSize&&e.totalNumberOfRecords?e.totalNumberOfRecords/e.pageSize:0,this.id=e.id,this.convertFromDecimal=e.convertFromDecimal.bind(this),this.convertToDecimal=e.convertToDecimal.bind(this),this.maximumNumberOfExplicitPagesToDisplay=e.maximumNumberOfExplicitPagesToDisplay,this.canPageBackward=this.currentPage>e.firstPage,this.canPageForward=this.currentPage<this.totalNumberOfPages,this.hasMorePagesBackward=!1,this.hasMorePagesForward=!1,this.currentPage>e.firstPage+2&&this.totalNumberOfPages>this.maximumNumberOfExplicitPagesToDisplay&&(this.hasMorePagesBackward=!0),this.currentPage<this.totalNumberOfPages-2&&this.totalNumberOfPages>this.maximumNumberOfExplicitPagesToDisplay&&(this.hasMorePagesForward=!0);var t,a;if(this.hasMorePagesBackward||this.hasMorePagesForward)if(this.hasMorePagesBackward)if(this.hasMorePagesForward){var i=this.maximumNumberOfExplicitPagesToDisplay%2===1,r=Math.ceil((this.maximumNumberOfExplicitPagesToDisplay-5)/2);this.currentPage+r===this.totalNumberOfPages-2?(this.hasMorePagesForward=!1,t=this.currentPage-r,a=this.totalNumberOfPages):i?(t=this.currentPage-r,a=this.currentPage+r+1):(t=this.currentPage-r+1,a=this.currentPage+r+1)}else a=this.totalNumberOfPages,t=this.totalNumberOfPages-this.maximumNumberOfExplicitPagesToDisplay+3;else t=e.firstPage+1,a=this.maximumNumberOfExplicitPagesToDisplay-1;else t=e.firstPage+1,a=this.totalNumberOfPages;for(this.pagesRange=[];t<a;t++)this.pagesRange.push({displayPage:e.convertFromDecimal(t),page:t})},e.prototype.buildPager=function(e){var t=this,i=this.createTemplates(e.templates),r=[],s=[],n=this.totalNumberOfPages>e.firstPage,o=e.convertFromDecimal(e.firstPage),g=e.convertFromDecimal(this.totalNumberOfPages);if(e.enableFirstLastPageArrows&&(r.push(this.buildButton(i.pageToBeginningHtml,"arrow-page-to-beginning",!this.canPageBackward,this.pageTo.bind(this,e.firstPage))),s.unshift(this.buildButton(i.pageToEndHtml,"arrow-page-to-end",!this.canPageForward,this.pageTo.bind(this,this.totalNumberOfPages)))),e.enablePageArrows&&(r.push(this.buildButton(i.pageRetreatHtml,"arrow-page-retreat",!this.canPageBackward,this.pageTo.bind(this,this.currentPage-1))),s.unshift(this.buildButton(i.pageAdvanceHtml,"arrow-page-advance",!this.canPageForward,this.pageTo.bind(this,this.currentPage+1)))),n){var p=i.pageToFirstHtml.replace(a.PagerTemplateConstants.PAGE_TO_FIRST_PLACEHOLDER,o.toString());r.push(this.buildButton(p,"page-to-beginning",!this.canPageBackward,this.pageTo.bind(this,e.firstPage))),p=i.pageToLastHtml.replace(a.PagerTemplateConstants.PAGE_TO_LAST_PLACEHOLDER,g.toString()),s.unshift(this.buildButton(p,"arrow-page-end",!this.canPageForward,this.pageTo.bind(this,this.totalNumberOfPages)))}if(this.hasMorePagesBackward&&r.push(this.buildButton(i.pageFillerBeforeHtml,"page-filler-before")),this.hasMorePagesForward&&s.unshift(this.buildButton(i.pageFillerAfterHtml,"page-filler-after")),this.pagesRange.forEach(function(e){var s=i.pageRangeHtml.replace(a.PagerTemplateConstants.PAGE_RANGE_PLACEHOLDER,e.displayPage);r.push(t.buildButton(s,"page-"+e.page,t.currentPage===e.page,t.pageTo.bind(t,e.page)))}),e.enablePageInput){var l=document.createElement("input");l.id="page-input-"+this.id,l.value=this.currentPage.toString(),l.addEventListener("blur",this.updateCurrentPage.bind(this),!1),this.input=l,s.push(l)}var h=document.createElement("div");return h.id="pager-container-"+this.id,r.concat(s).forEach(function(e){h.appendChild(e)}),h},e.prototype.buildButton=function(e,t,a,i){void 0===a&&(a=!0),void 0===i&&(i=null);var r=document.createElement("button");return r.id=t,a&&(r.disabled=!0),i&&r.addEventListener("click",i,!1),r.innerHTML=e,r},e}();t.Pager=i});